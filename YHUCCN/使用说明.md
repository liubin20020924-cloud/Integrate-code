# 云户科技网站 - Python 版本使用说明

## 项目重写完成说明

已成功将原PHP项目重写为Python Flask版本，并完成了以下工作：

✅ **已完成的任务:**
1. 创建项目基础结构和配置文件
2. 将首页拆分为独立组件:
   - `header.html` - 导航栏组件
   - `home.html` - 首页内容组件
   - `about.html` - 专业服务组件（含轮播图）
   - `services.html` - 业务介绍组件
   - `cases.html` - 用户案例组件
   - `solutions.html` - 解决方案组件
   - `contact.html` - 联系我们组件（含表单和弹窗）
   - `footer.html` - 页脚组件
3. 实现数据库功能（支持MySQL和SQLite）
4. 实现表单提交API（AJAX方式）
5. 创建留言管理后台页面
6. 保留所有原有样式和功能
7. 保留所有弹窗显示
8. 保留所有状态和交互效果

## 快速启动（推荐）

### 方法一：使用SQLite（最简单，无需配置数据库）

双击运行 `run_sqlite.bat` 或在命令行执行：

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 初始化数据库
python init_db_sqlite.py

# 3. 启动应用
python app_sqlite.py
```

访问: http://localhost:5000

### 方法二：使用MySQL（生产环境推荐）

1. 首先安装MySQL并创建数据库：
```sql
CREATE DATABASE clouddoors_db DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

2. 编辑 `.env` 文件配置数据库连接：
```env
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=clouddoors_db
DB_PORT=3306
SECRET_KEY=your-secret-key-change-in-production
```

3. 运行：
```bash
# 安装依赖
pip install -r requirements.txt

# 初始化数据库
python init_db.py

# 启动应用
python app.py
```

## 项目结构说明

```
cloud-doors/
├── app.py                  # Flask应用入口 (MySQL版本)
├── app_sqlite.py           # Flask应用入口 (SQLite版本)
├── config.py               # MySQL配置
├── config_sqlite.py        # SQLite配置
├── models.py               # 数据库模型
├── validators.py           # 表单验证
├── init_db.py              # MySQL数据库初始化
├── init_db_sqlite.py       # SQLite数据库初始化
├── requirements.txt        # Python依赖
├── .env                    # 环境变量配置
├── run.bat                 # Windows启动脚本 (MySQL版)
├── run_sqlite.bat          # Windows启动脚本 (SQLite版)
├── jpg/                    # 图片文件夹
├── clouddoors.db           # SQLite数据库文件 (自动生成)
├── routes/
│   ├── __init__.py
│   ├── main.py             # 主路由
│   ├── api.py              # API路由
│   └── admin.py            # 管理后台路由
└── templates/
    ├── base.html           # 基础模板
    ├── index.html          # 首页（组合所有组件）
    ├── admin/
    │   └── messages.html   # 留言管理页面
    └── components/
        ├── header.html     # 导航栏
        ├── home.html       # 首页横幅
        ├── about.html      # 专业服务
        ├── services.html   # 业务介绍
        ├── cases.html      # 用户案例
        ├── solutions.html  # 解决方案
        ├── contact.html    # 联系我们
        └── footer.html     # 页脚
```

## 功能验证

### 1. 首页功能
- ✅ 响应式导航栏（支持移动端菜单）
- ✅ 平滑滚动效果
- ✅ 返回顶部按钮
- ✅ 所有组件正常显示

### 2. 专业服务部分
- ✅ 桌面端标签页切换
- ✅ 移动端折叠面板
- ✅ 轮播图自动播放和手动切换
- ✅ 导航栏下拉菜单联动

### 3. 业务介绍
- ✅ 9个业务卡片展示
- ✅ 悬停动画效果

### 4. 用户案例
- ✅ 3个案例卡片展示

### 5. 解决方案
- ✅ 4个解决方案展示

### 6. 联系我们
- ✅ 表单验证（姓名、电话、邮箱、留言）
- ✅ AJAX表单提交
- ✅ 成功/失败弹窗提示
- ✅ 微信二维码弹窗
- ✅ 表单提交后自动清空

### 7. 数据库功能
- ✅ 留言数据保存
- ✅ 留言管理后台
- ✅ 搜索功能
- ✅ 分页显示

### 8. 样式保留
- ✅ 完全保留原有Tailwind CSS样式
- ✅ 保留所有自定义样式
- ✅ 响应式布局正常工作

## API接口文档

### 1. 提交表单
```
POST /api/submit-form

参数:
- name: 姓名 (必填)
- phone: 电话 (必填，手机号格式)
- email: 邮箱 (选填)
- message: 留言内容 (必填)

返回:
{
  "success": true,
  "message": "提交成功！您的留言ID是：1，我们会尽快与您联系。",
  "message_id": 1
}
```

### 2. 获取留言列表
```
GET /api/messages?search=关键词&page=1

参数:
- search: 搜索关键词 (可选)
- page: 页码 (可选，默认1)

返回:
{
  "success": true,
  "messages": [...],
  "total": 10,
  "pages": 1,
  "current_page": 1,
  "per_page": 20
}
```

### 3. 获取单条留言
```
GET /api/messages/{id}

返回:
{
  "success": true,
  "message": {...}
}
```

### 4. 删除留言
```
DELETE /api/messages/{id}

返回:
{
  "success": true,
  "message": "删除成功"
}
```

### 5. 更新留言状态
```
PUT /api/messages/{id}/status
Content-Type: application/json

Body:
{
  "status": 1  // 1:未处理, 2:已联系, 3:已完成
}

返回:
{
  "success": true,
  "message": "状态更新成功"
}
```

## 管理后台

访问 `/admin/messages` 可以：
- 查看所有留言
- 搜索留言（姓名、电话、内容）
- 分页浏览
- 查看留言状态
- 拨打电话
- 发送邮件

## 常见问题

### Q1: 启动时提示数据库连接失败？
**A:** 使用SQLite版本（运行 `run_sqlite.bat`），无需配置MySQL。

### Q2: 页面显示不正常？
**A:** 确保 `jpg` 文件夹存在且包含所有图片文件。

### Q3: 表单提交没有反应？
**A:** 打开浏览器开发者工具（F12），查看Console和Network标签的错误信息。

### Q4: 如何切换到MySQL？
**A:** 编辑 `.env` 文件配置MySQL连接信息，然后运行 `init_db.py` 和 `app.py`。

### Q5: 如何部署到生产环境？
**A:** 建议使用：
- Nginx/Apache 作为反向代理
- Gunicorn/uWSGI 作为WSGI服务器
- MySQL 作为数据库（不要在生产环境使用SQLite）

## 技术栈

- **后端**: Python 3.7+, Flask 3.0
- **数据库**: SQLite (开发) / MySQL (生产)
- **ORM**: SQLAlchemy
- **前端**: HTML5, Tailwind CSS, JavaScript (原生)
- **图标**: Font Awesome

## 开发说明

### 修改组件
所有页面组件都在 `templates/components/` 目录下，可以独立修改各个组件。

### 添加新组件
1. 在 `templates/components/` 创建新HTML文件
2. 在 `templates/index.html` 中使用 `{% include 'components/your-component.html' %}` 引入

### 修改样式
大部分样式在 `templates/base.html` 的 `<style>` 标签中，使用Tailwind CSS。

### 修改路由
路由定义在 `routes/` 目录下：
- `main.py` - 页面路由
- `api.py` - API路由
- `admin.py` - 管理后台路由

## 许可证

© 2025 云户科技（CLOUD-DOORS）. 保留所有权利。
